"use strict";(self["webpackChunkwms_web"]=self["webpackChunkwms_web"]||[]).push([[544],{544:function(t,e,s){s.r(e),s.d(e,{default:function(){return c}});var i=function(){var t=this,e=t._self._c;return e("div",[t.isVisible?e("el-button",{staticClass:"scroll-to-top",attrs:{circle:"",type:"success",icon:"el-icon-top"},on:{click:t.scrollToTop}}):t._e(),e("el-page-header",{staticStyle:{height:"25px","align-items":"center","margin-left":"1vw","margin-top":"1vw"},attrs:{content:"详情"},on:{back:t.goBack}}),e("div",{staticStyle:{display:"flex","flex-direction":"column","align-items":"center","margin-top":"30px"}},t._l(t.PostMain,(function(s,i){return e("el-card",{key:i,staticClass:"box-card"},[e("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-between"},attrs:{slot:"header"},slot:"header"},[t.isMobile?t._e():e("div",[e("el-avatar",{staticStyle:{margin:"0px 10px"},attrs:{size:40,src:s.post.avatar}},[t._v(t._s(s.post.userno.charAt(0)))]),e("span",{staticStyle:{position:"relative",top:"-12px","font-size":"1vw"}},[t._v(t._s(s.post.userno))])],1),e("div",{staticClass:"box-card-title"},[t.isMobile?t._e():e("span",{staticStyle:{"font-weight":"10","font-size":"1em",color:"#777777"}},[t._v(t._s(s.post.id)+".")]),e("span",{staticClass:"text2",staticStyle:{"padding-left":"10px"}},[t._v(t._s(s.post.title))])]),e("div",{staticStyle:{"font-weight":"10","font-size":"1em"}},[t._v(" "+t._s(new Date(s.post.time).getMonth()+1)+"/"+t._s(new Date(s.post.time).getDate())+" "),e("br"),t._v(" "+t._s(new Date(s.post.time).getHours())+":"+t._s(new Date(s.post.time).getMinutes())+" ")])]),t.isMobile?e("div",[e("el-avatar",{staticStyle:{margin:"0 10px"},attrs:{size:40,src:s.post.avatar}},[t._v(t._s(s.post.userno.charAt(0)))]),e("span",{staticStyle:{position:"relative",top:"-12px","font-size":"1em"}},[t._v(t._s(s.post.userno))])],1):t._e(),e("div",{staticClass:"text item",staticStyle:{"white-space":"pre-line",padding:"0 15px","min-height":"150px"}},[e("div",{directives:[{name:"highlight",rawName:"v-highlight"}],staticClass:"ql-editor",domProps:{innerHTML:t._s(s.post.name)}})]),e("div",{staticStyle:{display:"flex","justify-content":"flex-end"}},[e("span",{staticStyle:{"font-weight":"bold",color:"#0043a1","text-shadow":"0px 2px 3px rgb(73,230,255)",position:"relative",top:"5px"}},[t._v(" "+t._s(s.post.likenum)+" ")]),e("el-button",{staticStyle:{"margin-left":"10px"},attrs:{circle:"",icon:"el-icon-thumb",size:"small",type:"success"},on:{click:function(e){return t.like(s.post.id)}}}),e("el-button",{staticStyle:{"margin-left":"10px"},attrs:{circle:"",icon:"el-icon-share",size:"small",type:"warning"},on:{click:function(e){return t.copy(s.post.name)}}}),e("el-button",{staticStyle:{"margin-left":"10px"},attrs:{circle:"",icon:"el-icon-chat-dot-square",size:"small",type:"primary"},on:{click:function(e){return t.post2(s.post.id)}}}),e("el-button",{staticStyle:{"margin-left":"10px"},attrs:{circle:"",icon:"el-icon-star-off",size:"small",type:"info"},on:{click:function(e){return t.collect(s.post.id)}}})],1),t._l(s.post2,(function(i,o){return e("div",{key:o},[0===o?e("el-divider"):t._e(),e("div",{staticStyle:{width:"100%","min-height":"55px",display:"flex","justify-content":"space-between"}},[e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("el-avatar",{staticStyle:{margin:"0px 10px"},attrs:{size:30,src:i.avatar,shape:"square"}},[t._v(t._s(s.post.userno.charAt(0)))]),e("div",[e("span",{staticStyle:{"font-size":"12px","font-weight":"lighter",color:"#6e6e6e"}},[t._v(" "+t._s(i.userName))]),2!==i.roleId?e("el-tag",{staticStyle:{"margin-left":"5px","font-size":"10px"},attrs:{size:"mini",type:0===i.roleId?"danger":1===i.roleId?"warning":"info",effect:"plain"}},[t._v(" "+t._s(0===i.roleId?"超管":1===i.roleId?" 管理员":" "))]):t._e(),e("br"),e("span",{staticStyle:{"font-size":"16px"}},[t._v(" "+t._s(i.content))])],1)],1),e("div",{staticStyle:{"font-weight":"10","font-size":"14px"}},[t._v(" "+t._s(new Date(i.time).getMonth()+1)+"/"+t._s(new Date(i.time).getDate())+" "+t._s(new Date(i.time).getHours())+":"+t._s(new Date(i.time).getMinutes())+" ")])])],1)}))],2)})),1)],1)},o=[],a={name:"Post",data(){return{postId:"",PostMain:[],isMobile:!1,isVisible:!1,user:""}},beforeMount(){this.loadPost(),this.user=JSON.parse(sessionStorage.getItem("CurUser"))},created(){this.postId=this.$route.params.postId,window.addEventListener("scroll",this.handleScroll)},methods:{loadPost(){this.$axios.post(this.$httpUrl+"/post/listPage",{param:{postId:this.$route.params.postId}}).then((t=>t.data)).then((t=>{200===t.code?this.PostMain=t.data:alert("获取失败")}))},post2(t){this.$prompt("发表您的评论","评论",{confirmButtonText:"确定",cancelButtonText:"取消",inputErrorMessage:"不能发空的喔"}).then((({value:e})=>{this.$axios.post(this.$httpUrl+"/post2/save",{postId:t,userId:this.user.id,content:e}).then((t=>t.data)).then((t=>{200===t.code?(this.$notify({title:"感谢您的贡献，"+this.user.name,message:"上传成功",type:"success"}),this.loadPost()):this.$notify.error({title:"oops！发生了一些问题",message:"服务器开小差啦~请稍后再试"})}))})).catch((()=>{}))},like(t){this.$axios.get(this.$httpUrl+"/post/like?id="+t).then((t=>t.data)).then((t=>{200===t.code?(this.$message({showClose:!0,message:"点赞成功",type:"success"}),this.loadPost()):this.$message({showClose:!0,message:"服务器开小差啦~请稍后重试",type:"error"})}))},copy(t){const e=document.createElement("textarea");e.textContent=t,e.style.position="fixed",document.body.appendChild(e),e.select();try{document.execCommand("copy"),this.$notify({title:"内容已复制",message:"您可以粘贴分享",type:"success"})}catch(s){return this.$notify({title:"复制失败",type:"error"}),!1}finally{document.body.removeChild(e)}},collect(t){this.$axios.get(this.$httpUrl+"/userpost/add?userId="+this.user.id+"&postId="+t).then((t=>t.data)).then((t=>{200===t.code?409===t.data?this.$message({showClose:!0,message:"您已收藏",type:"success"}):this.$message({showClose:!0,message:"收藏成功",type:"success"}):this.$message({showClose:!0,message:"服务器开小差啦~请稍后重试",type:"error"})}))},goBack(){this.$router.replace("/Home")},checkIfMobile(){this.isMobile=window.innerWidth<768},handleScroll(){this.isVisible=window.scrollY>100},scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}},mounted(){this.checkIfMobile(),window.addEventListener("resize",this.checkIfMobile)}},n=a,l=s(1001),r=(0,l.Z)(n,i,o,!1,null,"1bc03ad2",null),c=r.exports}}]);
//# sourceMappingURL=544.c048f902.js.map