"use strict";(self["webpackChunkwms_web"]=self["webpackChunkwms_web"]||[]).push([[884],{8884:function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var o=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center","flex-direction":"column","padding-bottom":"60px"},style:{"background-image":"url("+e.imageUrl+")"}},[t("div",{staticStyle:{"margin-top":"40px","margin-bottom":"20px"}},[t("el-avatar",{staticStyle:{"font-size":"40px"},attrs:{size:200,src:this.user.avatar}},[e._v(e._s(this.user.name.charAt(0)))])],1),t("span",{staticStyle:{"font-size":"30px","font-weight":"lighter"}},[e._v(e._s(this.user.name))])]),t("div",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"center","align-items":"center"}},[t("el-row",{staticClass:"userRow",attrs:{gutter:20}},[t("el-col",{attrs:{span:6}},[t("div",[t("el-statistic",{attrs:{value:this.user.likes,"group-separator":",",title:"获赞量"}})],1)]),t("el-col",{attrs:{span:6}},[t("div",[t("el-statistic",{attrs:{value:this.user.postnum,"group-separator":",",title:"文章数"}})],1)]),t("el-col",{attrs:{span:6}},[t("div",[t("el-statistic",{attrs:{value:this.user.level,"group-separator":",",title:"等级"}})],1)]),t("el-col",{attrs:{span:6}},[t("div",[t("el-statistic",{attrs:{value:this.user.age,"group-separator":",",title:"年龄"}})],1)])],1),t("div",{staticStyle:{display:"flex","justify-content":"space-around","align-items":"center","flex-wrap":"wrap"}},[t("div",[t("el-descriptions",{staticClass:"userContent",attrs:{column:3,direction:"vertical",title:"个人信息"}},[t("el-descriptions-item",{attrs:{label:"账号"}},[e._v(e._s(this.user.no))]),t("el-descriptions-item",{attrs:{label:"用户名"}},[e._v(e._s(this.user.name))]),t("el-descriptions-item",{attrs:{span:2,label:"年龄"}},[e._v(e._s(this.user.age))]),t("el-descriptions-item",{attrs:{label:"性别"}},[e._v(" "+e._s(1==this.user.sex?"男":"女")+" ")]),e._v(" s "),t("el-descriptions-item",{attrs:{label:"手机号"}},[e._v(e._s(this.user.phone))]),t("el-descriptions-item",{attrs:{label:"等级"}},[t("el-progress",{staticClass:"dengJi",attrs:{color:e.colors,percentage:parseInt(this.user.level),"stroke-width":15,type:"dashboard"}})],1)],1),t("el-button",{staticStyle:{position:"relative",top:"-80px",left:"90px"},attrs:{icon:"el-icon-edit",size:"mini",type:"primary"},on:{click:function(t){return e.mod()}}},[e._v("修改信息 ")])],1),t("el-descriptions",{staticClass:"postS",staticStyle:{padding:"20px 20px","box-shadow":"0 2px 12px 0 rgba(0, 0, 0, 0.1)"},attrs:{column:1,direction:"vertical",title:"我的收藏"}},[t("el-descriptions-item",{attrs:{label:e.collectPost.length+" 篇文章"}},[t("div",{staticStyle:{height:"100%","overflow-y":"auto"}},e._l(e.collectPost,(function(s,o){return t("div",{key:o,staticClass:"postTitle"},[t("div",{staticStyle:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},on:{click:function(t){return e.goToPost(s.postId)}}},[e._v(" "+e._s(s.title)+" ")]),t("i",{staticClass:"el-icon-delete",on:{click:function(t){return e.delCollectPost(s.postId)}}})])})),0),0===e.collectPost.length?t("el-empty",{attrs:{description:"快添加喜欢的文章叭","image-size":80}}):e._e()],1)],1),t("div",{staticClass:"upload-demo"},[t("h2",{staticStyle:{"font-size":"16px","font-weight":"normal",margin:"15px","text-shadow":"0 0 5px #6dacfd, 0 0 10px #e1eaff"}},[e._v(" 更新头像")]),t("el-upload",{staticStyle:{"margin-bottom":"15px"},attrs:{action:`${this.postUrl}/user/up/${this.user.id}`,"before-upload":e.beforeUpload,"on-change":e.handleChange,accept:".jpg,.jpeg,.png",drag:"",multiple:""}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v("将图片拖到此处，或"),t("em",[e._v("点击上传")])])])],1)],1)],1),t("el-dialog",{attrs:{"before-close":e.handleClose,visible:e.centerDialogVisible,center:"",title:"用户",width:"30%"},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px","status-icon":""}},[t("el-form-item",{attrs:{label:"名称",prop:"name"}},[t("el-col",{attrs:{span:20}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-col",{attrs:{span:20}},[t("el-input",{attrs:{"show-password":""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1),t("el-form-item",{attrs:{label:"性别",prop:"sex"}},[t("el-radio-group",{attrs:{size:"small"},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[t("el-radio-button",{attrs:{label:"1"}},[e._v("男")]),t("el-radio-button",{attrs:{label:"0"}},[e._v("女")])],1)],1),t("el-form-item",{attrs:{label:"年龄",prop:"age"}},[t("el-col",{attrs:{span:20}},[t("el-input",{model:{value:e.form.age,callback:function(t){e.$set(e.form,"age",e._n(t))},expression:"form.age"}})],1)],1),t("el-form-item",{attrs:{label:"电话",prop:"phone"}},[t("el-col",{attrs:{span:20}},[t("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.save}},[e._v(e._s(e.loading?"提交中 ...":"确 定"))])],1)],1)],1)},r=[],a={name:"UserHome",components:{},data(){return{postUrl:this.$httpUrl,imageUrl:s(8550),centerDialogVisible:!1,user:JSON.parse(sessionStorage.getItem("CurUser")),loading:!1,deadline5:new Date("2024-03-02"),collectPost:[],colors:[{color:"#f56c6c",percentage:20},{color:"#e6a23c",percentage:40},{color:"#5cb87a",percentage:60},{color:"#1989fa",percentage:80},{color:"#6f7ad3",percentage:100}],form:{id:"",name:"",password:"",age:"",sex:"",phone:""},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],sex:[{required:!0,message:"请输入性别",trigger:"blur"}],age:[{required:!0,message:"请输入年龄",trigger:"blur"},{type:"number",message:"年龄必须为数字"}]}}},methods:{loadPost(){this.$axios.post(this.$httpUrl+"/user/find",this.form).then((e=>e.data)).then((e=>{200==e.code&&(sessionStorage.setItem("CurUser",JSON.stringify(e.data)),this.user=e.data)}))},loadCollect(){this.$axios.get(this.$httpUrl+"/userpost/list?userId="+this.user.id).then((e=>e.data)).then((e=>{200===e.code&&(this.collectPost=e.data)}))},goToPost(e){this.$router.replace("/Post/"+e)},delCollectPost(e){this.$axios.get(this.$httpUrl+"/userpost/del?userId="+this.user.id+"&postId="+e).then((e=>e.data)).then((e=>{200===e.code&&(this.$message({showClose:!0,message:"已取消收藏",type:"success"}),this.loadCollect())}))},resetForm(e){this.$refs[e].resetFields()},mod(){this.centerDialogVisible=!0,this.$nextTick((()=>{this.form.id=this.user.id,this.form.name=this.user.name,this.form.password="",this.form.age=this.user.age,this.form.sex=this.user.sex+"",this.form.phone=this.user.phone}))},save(){this.$refs["form"].validate((e=>{if(!e)return console.log("error submit!!"),!1;this.loading=!0,this.$axios.post(this.$httpUrl+"/user/update",this.form).then((e=>e.data)).then((e=>{200===e.code?(this.centerDialogVisible=!1,this.$message({showClose:!0,message:"修改成功",type:"success"}),this.loadPost(),this.loading=!1):this.$message({showClose:!0,message:"服务器开小差啦~请稍后重试",type:"error"})})),this.resetForm("form")}))},handleClose(e){this.$confirm("确认关闭？您的信息不会保存").then((()=>{e()})).catch((()=>{}))},handleChange(e,t){console.log(t),e.response&&200===e.response.code?(this.$message({showClose:!0,message:"更新成功",type:"success"}),sessionStorage.setItem("CurUser",JSON.stringify(e.response.data)),this.$user=e.response.data,this.user=e.response.data):e.response&&400===e.response.code&&this.$message({showClose:!0,message:"更新失败",type:"error"})},beforeUpload(e){const t="image/jpeg"===e.type,s="image/png"===e.type;return!(!t&&!s)||(this.$message({showClose:!0,message:"抱歉，只能上传 JPG 或 PNG 格式的图片",type:"error"}),!1)},autoLoad(){this.$axios.post(this.$httpUrl+"/user/find",{id:this.user.id}).then((e=>e.data)).then((e=>{200===e.code&&(this.user=e.data,sessionStorage.setItem("CurUser",JSON.stringify(e.data)))}))}},created(){this.loadCollect(),this.interval=setInterval(this.autoLoad,6e4)},beforeDestroy(){clearInterval(this.interval)}},i=a,l=s(1001),n=(0,l.Z)(i,o,r,!1,null,"36c441b0",null),c=n.exports},8550:function(e,t,s){e.exports=s.p+"img/Background.76ea90fb.jpg"}}]);
//# sourceMappingURL=884.da3a4d7c.js.map